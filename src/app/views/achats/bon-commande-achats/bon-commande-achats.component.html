
<div class="card d-flex py-1 my-2 mb-2">
  <div class="d-flex bd-highlight">
    <div class="flex-grow-1 bd-highlight">
      <button type="button" class="btn btn-success btn-sm mx-1" *ngIf="!modifToggle">Enregistrer</button>
      <button type="button" class="btn btn-danger btn-sm mx-1" *ngIf="!modifToggle" (click)="cancel()">Annuler</button>
    </div>
    <div class="bd-highlight">
      <button class="btn btn-outline-success btn-sm me-1"  title="Ajouter bon de commande" [ngStyle]="{display:showBtnAddBC}">
        <i class="fas fa-plus"></i>
      </button>
      <button class="btn btn-outline-success btn-sm me-1" (click)="openModalArticle()"  title="Ajouter article"[ngStyle]="{display:showBtnAddArticle}">
        <i class="fas fa-plus"></i>
      </button>
      <button [disabled]="!modifToggle" class="btn btn-outline-danger btn-sm me-1" [ngStyle]="{display:showSupprBc}" title="Supprimer bon de commande">
        <i class="fas fa-trash"></i>
      </button>
      <button class="btn btn-outline-primary btn-sm me-1" title="Liste bon de commande" (click)="toggleModal()" *ngIf="toggle">
        <i class="fas fa-list"></i>
      </button>
    </div>
  </div>
</div>
<div class="card d-flex"  *ngIf="!toggle">
    <div class="card-body py-1">
      <form #bonCommandeForm="ngForm">
        <div class="row m-2">
          <div class="col-sm-6">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">Date de commande</span>
              <input type="text" class="form-control col-7" name="datecommande" [(ngModel)]="dates.today" autocomplete="off" bsDatepicker >
            </div>
          </div>
          <div class="col-sm-6">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">Fournisseur</span>
              <input type="text" class="form-control col-6"  [value]="fournisseur.raison_social" aria-label="fournisseur" [disabled]="true"  aria-describedby="basic-addon1">
            </div>
          </div>
        </div>
        <div class="row m-2">
          <div class="col-sm-6">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">Exploitation</span>
              <input type="text" class="form-control col-7"   [value]="exploitation.libelle" [disabled]="true" aria-label="exploitation" aria-describedby="basic-addon1" >
            </div>
          </div>
          <div class="col-sm-6">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">Adresse Fournisseur</span>
              <input type="text" class="form-control col-7" [value]="fournisseur.adresse"  aria-label="adresse" [disabled]="true" aria-describedby="basic-addon1">
            </div>
          </div>
          
        </div>
        <div class="row m-2">
          <div class="col-sm-6">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">Centre de revenu</span>
              <select class="form-control col-7"  [required]="true" aria-label="centrerevenu" aria-describedby="basic-addon1">
                <option [ngValue]="item.id" *ngFor="let item of centres" >{{item.libelle}}</option>
              </select>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">N° bon de commande</span>
              <input type="text" class="form-control col-7" [(ngModel)]="num_commande" name="numCommande" aria-describedby="basic-addon1" >
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="card d-flex my-3" *ngIf="!toggle">
    <div class="card-body overflow-scroll py-1" style="height: 450px;">
      <table class="table table-striped my-3">
        <thead>
          <tr>
            <th>Famille</th>
            <th>Designation</th>
            <th>Qt commandé</th>
            <th>Prix unitaire HT </th>
            <th>Unité de commande</th>
            <th>Montant HT</th>
            <th>Remise en €</th>
            <th>Qté commandé FT</th>
            <th>Unité FT</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="card d-flex" *ngIf="toggle">
    <div class="card-body overflow-scroll py-1" style="height: 450px;">
      <table class="table table-striped table-hover">
        <thead>
        <tr>
          <th scope="col" class="">#</th>
          <th scope="col" class="col-1 text-overflow">Date Commande</th>
          <th scope="col" class="col-2">Désignation</th>
          <th scope="col" class="col-1">Qté Commandée</th>
          <th scope="col" class="col-2">Unité de Commande </th>
          <th scope="col" class="col-2">Prix Unitaire</th>
          <th scope="col" class="col-2">Montant HT</th>
          <th scope="col" class="col-2">Rémise</th>
          
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let line of commandes" (click)="showCommande(line)">
          <td class=""></td>  
          <td class="col-1">{{line.dateCommande}}</td>
          <td class="col-2">{{line.libelle}}</td>
          <td class="col-1">{{line.quantiteCommande}}</td>
          <td class="col-2 text-overflow">{{line.unite.abreviation}}</td>
          <td class="col-2">{{line.prixUnitaire}}</td>
          <td class="col-2">{{line.montantHT}}</td>
          <td class="col-2">{{line.remise}} </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  

  
<div class="modal" [ngStyle]="{display:modalFournisseur}" id="staticBackdropLive" data-coreui-backdrop="static" data-coreui-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLiveLabel" aria-hidden="true">
  <div class="modal-dialog ">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLiveLabel">Fournisseur</h5>
        <button class="btn-close" type="button" (click)="closeToggleModal()" data-coreui-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form #listFournisseur="">
            <div class="input-group">
              <span class="input-group-text col-5" id="basic-addon1">Liste des fournisseurs</span>
              <select class="form-control col-7"[(ngModel)]="fournisseur" [ngModelOptions]="{standalone: true}" [required]="true" aria-label="fournisseur" aria-describedby="basic-addon1">
                <option [ngValue]="line.id" *ngFor="let line of fournisseurs" >{{line.raison_social}}</option>
              </select>
            </div>
        </form>
      </div>
      <div class="text-center">
        <button class="btn btn-success m-1" (click)="addToggleModal()" type="button">Valider</button>
        <button class="btn btn-danger m-1" (click)="closeToggleModal()" type="button" data-coreui-dismiss="modal">Annuler</button>
        
      </div>
    </div>
  </div>
</div>


<div class="modal" [ngStyle]="{display:modalArticle}" id="staticBackdropLive" data-coreui-backdrop="static" data-coreui-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLiveLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLiveLabel">Ajout Article</h5>
        <button class="btn-close" type="button" (click)="closeToggleModalArticle()" data-coreui-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Séléction</th>
              <th>Désignation</th>
              <th>Code</th>
              <th>Famille</th>
              <th>Prix unitaire</th>
              <th>Unité</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of articleFournisseurs">
              <td> 
                <div class="form-check form-example-indeterminate">
                  <input class="form-check-input" id="flexCheckIndeterminate" type="checkbox">
                </div>
              </td>
              <td>{{ item.articles_libelle}}</td>
              <td>{{ item.articles_codeArticle}}</td>
              <td>{{ item.famille_libelle}}</td>
              <td>{{ item.articlefournisseur_prixReference}}</td>
              <td>{{ item.unites_abreviation}}</td>
              <td>{{ item.groupeanalytiques_type}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="text-center">
        <button class="btn btn-success m-1"  type="button">Valider</button>
        <button class="btn btn-danger m-1" (click)="closeToggleModalArticle()" type="button" data-coreui-dismiss="modal">Annuler</button>
        
      </div>
    </div>
  </div>
</div>